<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>음성 인식 예제</title>
</head>
<body>
    <h1>음성 인식 예제</h1>
    <p>마이크에 대고 말하세요...</p>
    <div id="result"></div>
    <script>
        // Web Speech API 지원 여부 확인
        if ('webkitSpeechRecognition' in window) {
            const recognition = new webkitSpeechRecognition();
            recognition.continuous = true; // 음성 인식을 계속 수행
            recognition.interimResults = false; // 중간 결과를 허용하지 않음
            recognition.lang = 'ko-KR'; // 한국어 설정

            recognition.onstart = function() {
                console.log("음성 인식 시작...");
            };

            recognition.onresult = function(event) {
                for (let i = event.resultIndex; i < event.results.length; ++i) {
                    if (event.results[i].isFinal) {
                        const recognizedText = event.results[i][0].transcript;
                        console.log("Google 음성 인식이 이렇게 들었습니다: " + recognizedText);

                        // 결과를 화면에 표시
                        document.getElementById('result').innerText = recognizedText;

                        // 여기에 recognizedText를 서버로 전송하는 코드를 추가할 수 있습니다.
                        // 예: fetch('http://yourserver.com/api/voice', {
                        //     method: 'POST',
                        //     headers: {
                        //         'Content-Type': 'application/json'
                        //     },
                        //     body: JSON.stringify({ text: recognizedText })
                        // });
                    }
                }
            };

            recognition.onerror = function(event) {
                console.error("음성 인식 오류: ", event.error);
            };

            recognition.onend = function() {
                console.log("음성 인식이 종료되었습니다. 다시 시작합니다...");
                recognition.start(); // 인식이 종료되면 다시 시작
            };

            // 음성 인식 시작
            recognition.start();
        } else {
            console.error("이 브라우저는 Web Speech API를 지원하지 않습니다.");
        }
    </script>
</body>
</html>
